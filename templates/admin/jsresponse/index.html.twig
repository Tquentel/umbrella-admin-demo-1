{% extends "@UmbrellaAdmin/layout.html.twig" %}

{% block content %}

{{ nav_config('pills', {'active_strategy': 'first'}) }}
{{ nav_start() }}
{{ nav_item({'label' : 'Exemple', 'url' : '#exemple'}) }}
{{ nav_item({'label' : 'How to', 'url': '#how-to'}) }}
{{ nav_end() }}

<div class="tab-content">
    <div class="tab-pane active" id="exemple">
        <div class="card">
            <div class="card-body">
                <h4 class="header-title">Link</h4>
                <ul class="list-group">

                    <li class="list-group-item">
                        <a data-xhr="{{ path('app_admin_jsresponse_toast') }}" href="#">
                            Server side toast action
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a data-xhr="{{ path('app_admin_jsresponse_toast') }}" href="#" data-confirm="Continuer ?">
                            Confirm > Server side toast action
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a data-xhr="{{ path('app_admin_jsresponse_sleep') }}" href="#" data-spinner="{{ 'common.loading' | trans }}">
                            Spinner > Server side toast action
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a data-xhr="{{ path('app_admin_jsresponse_error') }}" href="#">
                            Server error
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a data-xhr="{{ path('app_admin_jsresponse_unauthorized') }}" href="#">
                            Unauthorized
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a data-xhr="{{ path('app_admin_jsresponse_sleep', {sleep: 1}) }}" href="#" data-xhr-id="xhr-sleep">
                            Prevent multiple ajax request
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a data-xhr="{{ path('app_admin_jsresponse_custom') }}" href="#">
                            Custom Js Action
                        </a>
                    </li>
                </ul>


            </div>
        </div>
        <div class="card">
            <div class="card-body">
                <h4 class="header-title">Form</h4>
                <ul class="list-group">
                    <li class="list-group-item">
                        <form data-xhr="{{ path('app_admin_jsresponse_toast') }}">
                            <button type="submit" class="btn btn-primary">Server side toast action</button>
                        </form>
                    </li>
                    <li class="list-group-item">
                        <form data-xhr="{{ path('app_admin_jsresponse_toast') }}" data-confirm="Continuer ?">
                            <button type="submit" class="btn btn-primary">Confirm > Server side toast action</button>
                        </form>
                    </li>
                    <li class="list-group-item">
                        <form data-xhr="{{ path('app_admin_jsresponse_sleep') }}" href="#" data-spinner="{{ 'common.loading' | trans }}">
                            <button type="submit" class="btn btn-primary">Spinner > Server side toast action</button>
                        </form>
                    </li>
                </ul>
            </div>
    </div>
    </div>

    <div class="tab-pane" id="how-to">
        <div class="card">
            <div class="card-body">

                <h4 class="card-title">-- Client side --</h4>

                <h5 class="card-title">Lien asynchrone</h5>

                <p>Utiliser l'attribut <b>data-xhr</b> sur un lien afin qu'une requète ajax soit envoyé au serveur lors du clic sur celui-ci.</p>
                <pre class="border-dark border p-2">{{ source('admin/jsresponse/_async_link.txt') | e('html') }}</pre>

                <h5 class="card-title">Form asynchrone</h5>
                <p>Utiliser l'attribut <b>data-xhr</b> sur un form afin qu'une requète ajax soit envoyé au serveur lors de la soumission de celui-ci (l'ensemble des données du formulaire seront aussi envoyées).</p>
                <pre class="border-dark border p-2">{{ source('admin/jsresponse/_async_form.txt') | e('html') }}</pre>

                <h5 class="card-title">Appel asynchrone en js</h5>
                <p>Il est aussi possible de faire un appel asynchrone directement en Javascript.</p>
                <pre class="border-dark border p-2">{{ source('admin/jsresponse/_async_js.txt') | e('html') }}</pre>
                <p>Options disponibles :</p>
                <ul>
                    <li>Toutes les options disponibles avec la function jQuery $.ajax : <b>url, method, data, ...</b></li>
                    <li>Les options de AjaxUtils : <b>spinner, confirm, ...</b></li>
                </ul>

                <h4 class="card-title">-- Server side --</h4>
                <p class="alert alert-warning">
                    Si vous éffectuez un appel asynchrone de cette manière, vous devez toujours retourner une réponse JSON côté seveur qui respectera un certain format.
                </p>

                <p>Format attendu : </p>
                <pre class="border-dark border p-2">{{ source('admin/jsresponse/_async_response.txt') }}</pre>

                <p>Chaque action sera alors évalué par le javascript afin d'éxecuter une action côté client (ouvrir une modal, afficher un toast, ...)</p>

                <h5 class="card-title">Controller symfony (exemple de réponse)</h5>
                <pre class="border-dark border p-2">{{ source('admin/jsresponse/_controller.txt') | e('html') }}</pre>
            </div>
        </div>
    </div>
</div>
{% endblock %}